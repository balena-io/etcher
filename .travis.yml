language: cpp
sudo: false

env:
  - NODE_VERSION="6.1.0" RUBY_VERSION="2.3.1"

# C++11 support
# See https://github.com/PacificBiosciences/pbdagcon/pull/7

compiler:
  - gcc

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - debhelper
      - devscripts
      - quilt
      - lintian
      - libwww-perl
      - libcrypt-ssleay-perl # https://github.com/travis-ci/apt-package-whitelist/issues/3380
      - gcc-4.8
      - g++-4.8
      - clang
      - libasound2-dev
      - libcap-dev
      - libcups2-dev
      - libfontconfig1-dev
      - libfreetype6-dev
      - libexpat1-dev
      - libgtk2.0-dev
      - libgconf2-dev
      - liblzma-dev

before_install:
  #- uscan --verbose --download-current-version
  - wget -O ../etcher_1.0.0~beta.15.orig.tar.gz https://github.com/resin-io/etcher/archive/v1.0.0-beta.15.tar.gz
  - rm -rf ~/.nvm
  - git clone https://github.com/creationix/nvm.git ~/.nvm
  - source ~/.nvm/nvm.sh
  - nvm --version
  - nvm install $NODE_VERSION
  - node --version
  - npm --version
  - npm config set spin=false
  - rvm install $RUBY_VERSION
  - rvm use $RUBY_VERSION

install:
  - if [ "$CXX" = "g++" ]; then
      export CXX="g++-4.8" CC="gcc-4.8";
    fi
  - gem install scss_lint
  - npm install -g bower
  - QUILT_PATCHES=debian/patches quilt push -a
  - ./scripts/build/linux.sh install x64

script:
  - debuild --preserve-envvar PATH -us -uc
